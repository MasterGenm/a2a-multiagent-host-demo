name: Python Application CI

# 触发工作流程的事件
on:
  push:
    branches: [ "main" ] # 当推送到 main 分支时
  pull_request:
    branches: [ "main" ] # 当向 main 分支提交 Pull Request 时

jobs:
  build-and-test:
    # 运行此任务的虚拟机环境
    runs-on: ubuntu-latest

    steps:
      # 步骤1: 检出（下载）代码到虚拟机
      - name: Checkout repository
        uses: actions/checkout@v4

      # 步骤2: 设置 Python 环境
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'

      # 步骤3: 安装项目依赖
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      # 步骤4: 运行自动化测试 (最关键的一步)
      - name: Run tests with pytest
        run: |
          pytest